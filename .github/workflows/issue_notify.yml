name: Notify on Issue Created + Create ClickUp Task

on:
  issues:
    types: [opened]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      # Paso 1: enviar correo
      - name: Send email on new issue
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: smtp.gmail.com
          server_port: 587
          username: ${{ secrets.EMAIL_USER }}
          password: ${{ secrets.EMAIL_PASS }}
          subject: "🔔 Nuevo Issue en GitHub: ${{ github.event.issue.title }}"
          to: "syactayocrisostomo@gmail.com, sebascha.sistemas2003@gmail.com"
          from: "GitHub Actions <${{ secrets.EMAIL_USER }}>"
          body: |
            ¡Se creó un nuevo Issue en el repositorio!

            📌 Título: ${{ github.event.issue.title }}
            📝 Descripción: ${{ github.event.issue.body }}
            🔗 Link: ${{ github.event.issue.html_url }}

      # Paso 2: crear tarea en ClickUp
      - name: Create ClickUp Task
        run: |
          curl -X POST "https://api.clickup.com/api/v2/list/901320344286/task" \
            -H "Authorization: ${{ secrets.CLICKUP_API_TOKEN }}" \
            -H "Content-Type: application/json" \
            -d "{
              \"name\": \"${{ github.event.issue.title }}\",
              \"description\": \"${{ github.event.issue.body }}\n\n🔗 [Ver Issue en GitHub](${{ github.event.issue.html_url }})\",
              \"status\": \"to do\"
            }"
